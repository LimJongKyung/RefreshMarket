<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" class="h-100" data-bs-theme="auto">
	<head>
	    <th:block th:insert="~{template/refresh/fragments/block :: config}"></th:block>
	    <meta name="theme-color" content="#712cf9">
	    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">
	    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
	    <link href="/assets/dist/css/refreshmain.css" rel="stylesheet">
	    <link href="/assets/dist/mainproductboardcss/Purchase.css" rel="stylesheet">
	</head>
	<body class="d-flex h-100 text-center text-bg-dark">
	    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
	        <header class="mb-auto">
	            <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
	                <th:block th:insert="~{template/refresh/fragments/blocklogin :: header}"></th:block>
	                <th:block th:insert="~{template/refresh/fragments/blocklogin :: brandName}"></th:block>
	                <th:block th:insert="~{template/refresh/fragments/blocklogin :: mainNavbar}"></th:block>
	                <th:block th:insert="~{template/refresh/fragments/blocklogin :: sideNavbar}"></th:block>
	            </nav>
	        </header>
	    </div>    
	    <main style="max-width:600px; margin: 40px auto; padding: 0 20px; font-family: 'Noto Sans KR', sans-serif;">
		  <h2 style="text-align:center; margin-bottom:30px;" th:text="'κµ¬λ§¤μ, ' + ${username} + ' κ³ κ°λ‹!'"></h2>
		
		  <!-- κΈ°μ΅΄ μ •λ³΄ λ¶λ¬μ¤κΈ° μ²΄ν¬λ°•μ¤ -->
		  <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px;">
		    <input type="checkbox" id="loadExistingInfo">
		    κΈ°μ΅΄ μ •λ³΄ λ¶λ¬μ¤κΈ°
		  </label>
		
		  <form id="guestOrderForm" action="/products/order" method="post" style="display: flex; flex-direction: column; gap: 15px;">
		    <input type="hidden" id="customerId" name="customerId" th:value="${userId}" />
		    
		    <label>
		      μ΄λ¦„
		      <input type="text" id="customerName" name="customerName" required placeholder="μ΄λ¦„μ„ μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px; font-size:1rem;"/>
		    </label>
		
		    <label>
		      μ΄λ©”μΌ
		      <input type="email" id="email" name="email" required placeholder="μ΄λ©”μΌμ„ μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px; font-size:1rem;"/>
		    </label>
		
		    <label>
		      μ „ν™”λ²νΈ
		      <input type="tel" id="phoneNumber" name="phoneNumber" required placeholder="μ „ν™”λ²νΈλ¥Ό μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px; font-size:1rem;"/>
		    </label>
		
		    <label>
		      λ°°μ†΅ μ£Όμ†
		      <button type="button" onclick="execDaumPostcode()" style="padding:8px 12px; font-size:1rem; background-color:#007bff; color:#fff; border:none; border-radius:4px; cursor:pointer; margin-bottom:10px;">
		        μ£Όμ† κ²€μƒ‰
		      </button>
		      <input type="text" id="roadAddress" placeholder="μ£Όμ†κ²€μƒ‰" readonly style="width:100%; padding:8px; margin-bottom:10px;" />
		      <input type="text" id="detailAddress" placeholder="μƒμ„Έ μ£Όμ†λ¥Ό μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px;" />
		      
		      <!-- μ„λ²„ μ „μ†΅μ© hidden input -->
		      <input type="hidden" name="shippingAddress" id="shippingAddress" />
		    </label>
		
		    <label>
		      λ°°μ†΅ μ”μ²­μ‚¬ν•­
		      <input type="text" name="deliveryRequest" placeholder="λ°°μ†΅ μ”μ²­μ‚¬ν•­μ΄ μμΌλ©΄ μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px; font-size:1rem;"/>
		    </label>
		
		    <label>
		      κ²°μ  λ°©λ²•
		      <select name="paymentMethod" required style="width:100%; padding:8px; font-size:1rem;">
		        <option value="" disabled selected>κ²°μ  λ°©λ²•μ„ μ„ νƒν•μ„Έμ”</option>
		        <option value="μΉ΄λ“">μΉ΄λ“</option>
		        <option value="κ³„μΆμ΄μ²΄">κ³„μΆμ΄μ²΄</option>
		      </select>
		    </label>
		
			<!-- λ³΄μ  ν¬μΈνΈ ν‘μ‹ -->
			<p>λ³΄μ  ν¬μΈνΈ: <span id="memberPointValue" th:text="${memberInfo.point ?: 0}">0</span>μ›</p>
			
			<!-- μ‚¬μ©ν•  ν¬μΈνΈ μ…λ ¥ -->
			<label>
			  μ‚¬μ©ν•  ν¬μΈνΈ
			  <input type="number" id="usedPoint" name="usedPoint" min="0" placeholder="μ‚¬μ©ν•  ν¬μΈνΈλ¥Ό μ…λ ¥ν•μ„Έμ”" style="width:100%; padding:8px; font-size:1rem;" />
			</label>
			
		    <!-- μΏ ν° μ„ νƒ μμ—­ -->
		    <div class="user-benefits">
		      <h3>π μΏ ν° μ‚¬μ©</h3>
		      <select id="benefitSelector">
		        <option value="">-- μΏ ν°μ„ μ„ νƒν•μ„Έμ” --</option>
		        <option th:each="benefit : ${benefits}"
		                th:value="${benefit.benefitDescription}"
		                th:text="${benefit.benefitName + ' - ' + benefit.benefitDescription}">
		        </option>
		      </select>
		    </div>
		    
		    <!-- μ„ νƒλ μΏ ν° ν‘μ‹ μμ—­ -->
		    <ul id="selectedBenefitsList" style="margin-top:10px; padding-left:20px;"></ul>
		    
		    <!-- κ²½κ³  λ¬Έκµ¬ -->
		    <p id="benefitWarning" style="margin-top:10px; font-weight:bold; color:red;"></p>
		
		    <div id="cartItems"></div>
		    <p id="deliveryCharges"></p>
		    <p id="totalQuantity"></p>
		    <p id="totalPrice"></p>
		    <p id="purchaseTotal"></p>
		
		    <!-- κΈ°μ΅΄ μ¨κ²¨μ§„ μ¥λ°”κµ¬λ‹ JSON λ°μ΄ν„° ν•„λ“ -->
		    <input type="hidden" name="cartData" id="cartData" />
		    <input type="hidden" name="quantities" id="quantities" />
		    <input type="hidden" name="usedBenefits" id="usedBenefits" />
		    
		    <button type="submit">κµ¬λ§¤ ν™•μ •</button>
		  </form>
		</main>
	    <footer class="mt-auto text-white-50">
    		<th:block th:insert="~{template/refresh/fragments/block :: footer}"></th:block>
    	</footer>
	    <script src="https://js.tosspayments.com/v1"></script>
		<script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
	    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	    <script src="/js/jquery-3.7.1.min.js"></script>
	    <script src="/assets/dist/mainproductboardjs/purchase.js"></script>
	    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
	</body>
</html>